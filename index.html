<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoNSales Dashboard</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Local stylesheet (custom styles) -->
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js for trends -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <!-- Firebase SDK (import map -> local node_modules ESM builds) -->
        <script type="importmap">
        {
            "imports": {
                "firebase/app": "/node_modules/firebase/app/dist/esm/index.esm.js",
                "firebase/analytics": "/node_modules/firebase/analytics/dist/esm/index.esm.js",
                "firebase/firestore": "/node_modules/firebase/firestore/dist/esm/index.esm.js",
                "firebase/auth": "/node_modules/firebase/auth/dist/esm/index.esm.js"
            }
        }
        </script>

        <script type="module">
            import { initializeApp } from 'firebase/app';
            import { getAnalytics } from 'firebase/analytics';
            import {
                getFirestore,
                collection,
                doc,
                getDocs,
                getDoc,
                setDoc,
                updateDoc,
                onSnapshot,
                query,
                where,
                addDoc,
                deleteDoc,
                connectFirestoreEmulator
            } from 'firebase/firestore';
            import {
                getAuth,
                signInWithEmailAndPassword,
                signOut,
                onAuthStateChanged
            } from 'firebase/auth';

            const firebaseConfig = {
                apiKey: "AIzaSyBU4BeGoO1k_q6aNNOf4VtEkXxL97oPRi8",
                authDomain: "gonsales-b4087.firebaseapp.com",
                projectId: "gonsales-b4087",
                storageBucket: "gonsales-b4087.firebasestorage.app",
                messagingSenderId: "674100483667",
                appId: "1:674100483667:web:2a6feef6533d3d1590d8a6",
                measurementId: "G-3Y9FR5N86G"
            };

            let app = null;
            try {
                app = initializeApp(firebaseConfig);
            } catch (e) {
                console.warn('Failed to initialize Firebase app:', e && e.message);
            }

            let analytics = null;
            try {
                if (typeof getAnalytics === 'function' && app) analytics = getAnalytics(app);
            } catch (e) {
                // ignore analytics errors
            }

            const db = app ? getFirestore(app) : null;
            const auth = app ? getAuth(app) : null;

            window.firebase = {
                db,
                auth,
                firestore: {
                    collection,
                    doc,
                    getDocs,
                    getDoc,
                    setDoc,
                    updateDoc,
                    onSnapshot,
                    query,
                    where,
                    addDoc,
                    deleteDoc
                },
                authFunctions: {
                    signInWithEmailAndPassword,
                    signOut,
                    onAuthStateChanged
                }
            };
            // expose convenience function for emulator connection
            try { window.firebase.connectFirestoreEmulator = connectFirestoreEmulator; } catch (e) {}
        </script>
    <!-- Login Modal -->
    <div id="login-modal" class="login-modal hidden">
        <div class="login-form">
            <h2 class="text-2xl font-bold text-center mb-6 text-gray-800">Login Required</h2>
            <p id="login-prompt" class="text-center text-gray-600 mb-4">Please log in to access editing features.</p>
            <form id="login-form">
                <input type="email" id="login-email" class="login-input" placeholder="Email" required>
                <input type="password" id="login-password" class="login-input" placeholder="Password" required>
                <div id="password-strength" class="password-strength hidden">
                    <div class="strength-bar">
                        <div class="strength-fill"></div>
                    </div>
                    <div class="strength-text"></div>
                    <ul class="password-requirements"></ul>
                </div>
                <button type="submit" id="login-button" class="login-button">Login</button>
            </form>
            <p id="login-error" class="error-message hidden"></p>
            <p class="text-xs text-center text-gray-500 mt-4">Enter your credentials to access admin features</p>
        </div>
    </div>

    <!-- Add Date Modal -->
    <div id="add-date-modal" class="add-date-modal hidden">
        <div class="add-date-form">
            <h2 class="text-xl font-bold text-center mb-6 text-gray-800">Add New Date</h2>
            <form id="add-date-form">
                <input type="date" id="new-date" class="date-input" required>
                <div class="modal-buttons">
                    <button type="button" class="cancel-button" onclick="hideAddDateModal()">Cancel</button>
                    <button type="submit" class="save-button">Add Date</button>
                </div>
            </form>
        </div>
    </div>

    <!-- DE Add/Edit Modal -->
    <div id="de-modal" class="de-modal hidden">
        <div class="de-form">
            <h2 class="text-xl font-bold text-center mb-4 text-gray-800">Add / Edit DE</h2>
            <form id="de-form">
                <input type="hidden" id="de-id">
                <div class="grid grid-cols-1 gap-3">
                    <input type="text" id="de-name" class="login-input" placeholder="DE Name" required>
                    <input type="text" id="de-deid" class="login-input" placeholder="DE ID" required>
                    <input type="text" id="de-region" class="login-input" placeholder="Region">
                    <input type="text" id="de-captain" class="login-input" placeholder="Captain Name">
                    <input type="number" id="de-last" class="login-input" placeholder="Last Month Actual" min="0">
                    <input type="number" id="de-current" class="login-input" placeholder="This Month Actual" min="0">
                    <input type="text" id="de-slab" class="login-input" placeholder="Slab (Gold/Silver/Bronze)">
                </div>
                <div class="modal-buttons mt-4">
                    <button type="button" class="cancel-button" onclick="closeDEModal()">Cancel</button>
                    <button type="submit" class="save-button">Save DE</button>
                </div>
            </form>
        </div>
    </div>

    <!-- DSR Add/Edit Modal -->
    <div id="dsr-modal" class="de-modal hidden">
        <div class="de-form">
            <h2 class="text-xl font-bold text-center mb-4 text-gray-800">Add / Edit DSR</h2>
            <form id="dsr-form">
                <input type="hidden" id="dsr-id">
                <div class="grid grid-cols-1 gap-3">
                    <input type="text" id="dsr-name" class="login-input" placeholder="DSR Name" required>
                    <input type="text" id="dsr-dsrid" class="login-input" placeholder="DSR ID" required>
                    <input type="text" id="dsr-cluster" class="login-input" placeholder="Cluster">
                    <input type="text" id="dsr-captain" class="login-input" placeholder="Captain Name">
                    <input type="number" id="dsr-last" class="login-input" placeholder="Last Month Actual" min="0">
                    <input type="number" id="dsr-current" class="login-input" placeholder="This Month Actual" min="0">
                    <input type="text" id="dsr-slab" class="login-input" placeholder="Slab (Gold/Silver/Bronze)">
                </div>
                <div class="modal-buttons mt-4">
                    <button type="button" class="cancel-button" onclick="closeDSRModal()">Cancel</button>
                    <button type="submit" class="save-button">Save DSR</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-xl font-bold text-gray-900">Silver Sales Dashboard</h1>
                    </div>
                    <nav class="ml-6 flex space-x-4" aria-label="Main navigation">
                        <a id="nav-dashboard" href="#" class="nav-item px-3 py-2 rounded-md text-sm font-medium bg-green-50 text-green-700 flex items-center space-x-2" onclick="navigateTo('dashboard')" aria-label="Dashboard" aria-describedby="nav-tooltip-dashboard">
                            <!-- Home icon -->
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9.75L12 3l9 6.75V20a1 1 0 01-1 1h-5v-6H9v6H4a1 1 0 01-1-1V9.75z"></path></svg>
                            <span class="nav-label">Dashboard</span>
                            <span id="nav-tooltip-dashboard" class="nav-tooltip" role="tooltip">Dashboard</span>
                        </a>
                        <a id="nav-target-setting" href="#" class="nav-item px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100 flex items-center space-x-2" onclick="navigateTo('target-setting')" aria-label="Target Setting" aria-describedby="nav-tooltip-target-setting">
                            <!-- Target icon -->
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3l2 2m6-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span class="nav-label">Target Setting</span>
                            <span id="nav-tooltip-target-setting" class="nav-tooltip" role="tooltip">Target Setting</span>
                        </a>
                        <a id="nav-sales-log" href="#" class="nav-item px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100 flex items-center space-x-2" onclick="navigateTo('sales-log')" aria-label="Sales Log" aria-describedby="nav-tooltip-sales-log">
                            <!-- Calendar icon -->
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            <span class="nav-label">Sales Log</span>
                            <span id="nav-tooltip-sales-log" class="nav-tooltip" role="tooltip">Sales Log</span>
                        </a>
                        <a id="nav-dsr-performance" href="#" class="nav-item px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100 flex items-center space-x-2" onclick="navigateTo('dsr-performance')" aria-label="DSR Performance" aria-describedby="nav-tooltip-dsr">
                            <!-- Person icon -->
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A9 9 0 1118.879 6.196 9 9 0 015.121 17.804zM15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                            <span class="nav-label">DSR Performance</span>
                            <span id="nav-tooltip-dsr" class="nav-tooltip" role="tooltip">DSR Performance</span>
                        </a>
                        <a id="nav-de-performance" href="#" class="nav-item px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100 flex items-center space-x-2" onclick="navigateTo('de-performance')" aria-label="Dealer Performance" aria-describedby="nav-tooltip-de">
                            <!-- Shop icon -->
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l9-6 9 6M4 10v8a2 2 0 002 2h12a2 2 0 002-2v-8"></path></svg>
                            <span class="nav-label">Dealer (DE) Performance</span>
                            <span id="nav-tooltip-de" class="nav-tooltip" role="tooltip">Dealer Performance</span>
                        </a>
                    </nav>
                </div>
                <div class="flex items-center">
                    <span id="header-title" class="text-lg font-semibold text-gray-700 mr-4">Dashboard</span>
                    <!-- Compact title shown when sidebar collapsed on very small screens -->
                    <span id="compact-title" class="compact-title hidden">GoNSales</span>
                    <div class="flex items-center">
                        <span id="current-user-id" class="text-xs text-gray-500">Public View</span>
                        <span id="user-status" class="user-status unauthenticated">View Only</span>
                        <button id="logout-button" class="ml-2 px-3 py-1 text-xs bg-red-100 text-red-700 rounded-md hover:bg-red-200 hidden" onclick="handleLogout()">Logout</button>
                        <button id="reset-targets-button" class="ml-2 px-3 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-md hover:bg-yellow-200 hidden" onclick="resetTargetsAndAchievements()">Reset Targets</button>
                        <!-- Sidebar toggle for very small screens -->
                        <button id="sidebar-toggle" class="ml-2 px-3 py-1 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 hidden" onclick="toggleSidebar()" aria-label="Toggle navigation sidebar">â˜°</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Toast container -->
    <div id="toast-container" class="fixed bottom-6 right-6 space-y-2 z-50"></div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Loading Spinner -->
        <div id="loading-spinner" class="loading-spinner hidden"></div>

        <!-- Dashboard View -->
        <div id="dashboard-view">
            <!-- Metric Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" id="dashboard-metrics">
                <!-- Cards will be populated by JavaScript -->
            </div>

            <!-- Performance Table -->
            <div class="bg-white rounded-lg shadow p-6 mb-8">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Sales Performance</h3>
                <div class="overflow-x-auto">
                    <table class="performance-table min-w-full">
                        <thead>
                            <tr>
                                <th>Sales Personnel</th>
                                <th>Monthly Target</th>
                                <th>MTD Target</th>
                                <th>MTD Actual</th>
                                <th>% vs Target</th>
                                <th>Gap</th>
                            </tr>
                        </thead>
                        <tbody id="performance-table-body">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                        <tfoot id="performance-table-footer">
                            <!-- Footer will be populated by JavaScript -->
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- DSR Performance Trend -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-medium text-gray-900">DSR Performance Trend</h3>
                    <div class="flex space-x-2">
                        <select id="trend-period" class="search-input" onchange="updateDSRTrendChart()">
                            <option value="7">Last 7 Days</option>
                            <option value="30" selected>Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                        </select>
                        <select id="trend-metric" class="search-input" onchange="updateDSRTrendChart()">
                            <option value="sales" selected>Sales Performance</option>
                            <option value="slab">Slab Distribution</option>
                            <option value="cluster">Cluster Performance</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Sales Trend Chart -->
                    <div>
                        <h4 class="text-md font-medium text-gray-700 mb-4">Sales Trend</h4>
                        <div class="chart-container">
                            <canvas id="salesTrendChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Slab Distribution Chart -->
                    <div>
                        <h4 class="text-md font-medium text-gray-700 mb-4">Performance Slab Distribution</h4>
                        <div class="chart-container">
                            <canvas id="slabDistributionChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Top Performers Table -->
                <div class="mt-8">
                    <h4 class="text-md font-medium text-gray-700 mb-4">Top Performers</h4>
                    <div class="overflow-x-auto">
                        <table class="performance-table min-w-full">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>DSR Name</th>
                                    <th>Cluster</th>
                                    <th>Captain</th>
                                    <th>Current Month</th>
                                    <th>Last Month</th>
                                    <th>Growth</th>
                                    <th>Slab</th>
                                </tr>
                            </thead>
                            <tbody id="top-performers-body">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- DE (Dealer) Sales on Dashboard -->
            <div class="bg-white rounded-lg shadow p-6 mt-6">
                <h3 class="text-lg font-medium text-gray-900 mb-4">DE (Dealer) Sales</h3>
                <div class="overflow-x-auto">
                    <table class="performance-table min-w-full">
                        <thead>
                            <tr>
                                <th>DE Name</th>
                                <th>DE ID</th>
                                <th>Region</th>
                                <th>This Month</th>
                                <th>Last Month</th>
                                <th>Growth</th>
                                <th>Slab</th>
                            </tr>
                        </thead>
                        <tbody id="de-dashboard-table-body">
                            <!-- Populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Target Setting View -->
        <div id="target-setting-view" class="hidden">
            <div class="bg-white rounded-lg shadow overflow-hidden mb-8">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h2 class="text-lg font-medium text-gray-900">Sales Target Setting</h2>
                    <p class="mt-1 text-sm text-gray-500">Set monthly and MTD targets for each sales personnel.</p>
                </div>
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="target-table min-w-full">
                            <thead>
                                <tr>
                                    <th>Sales Personnel</th>
                                    <th>Monthly Target (Units)</th>
                                    <th>MTD Target (Units)</th>
                                    <th>MTD Actual (Units)</th>
                                    <th>% vs Target</th>
                                    <th>Gap</th>
                                </tr>
                            </thead>
                            <tbody id="target-table-body">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                            <tfoot id="target-table-footer">
                                <!-- Footer will be populated by JavaScript -->
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h2 class="text-lg font-medium text-gray-900">Infrastructure Performance</h2>
                    <p class="mt-1 text-sm text-gray-500">Monitor dealer base and DSR performance.</p>
                </div>
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="target-table min-w-full">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Base</th>
                                    <th>Active</th>
                                    <th>Inactive</th>
                                    <th>Performance</th>
                                </tr>
                            </thead>
                            <tbody id="infra-table-body">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                            <tfoot id="infra-table-footer">
                                <!-- Footer will be populated by JavaScript -->
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sales Log View -->
        <div id="sales-log-view" class="hidden">
            <!-- Sales Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8" id="sales-summary-cards">
                <!-- Cards will be populated by JavaScript -->
            </div>

            <!-- Sales Log Table -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-lg font-medium text-gray-900">Daily Sales Log</h2>
                            <p class="mt-1 text-sm text-gray-500">Track daily sales for each sales personnel. Click on any cell to edit.</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="text-sm text-gray-600">Days Worked&nbsp;&nbsp;<span id="days-worked" class="days-badge" role="status" aria-live="polite">4</span></div>
                            <div class="flex space-x-2">
                            <button class="add-date-btn" onclick="showAddDateModal()">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                                Add Date
                            </button>
                            <button class="px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500" onclick="filterSalesLog('captain')">
                                Captain View
                            </button>
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <div class="overflow-x-auto max-h-96">
                        <table class="sales-log-table">
                            <thead>
                                <tr id="sales-log-caption-row">
                                    <!-- Header will be populated by JavaScript -->
                                </tr>
                            </thead>
                            <tbody id="sales-log-table-body">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                            <tfoot id="sales-log-table-footer">
                                <!-- Footer will be populated by JavaScript -->
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- DSR Performance View -->
        <div id="dsr-performance-view" class="hidden">
            <div class="bg-white rounded-lg shadow overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-lg font-medium text-gray-900">DSR Performance</h2>
                            <p class="mt-1 text-sm text-gray-500" id="dsr-performance-description">
                                <!-- Description will be updated based on authentication status -->
                            </p>
                        </div>
                        <div class="flex space-x-2">
                            <input type="text" id="dsr-search" class="search-input" placeholder="Search DSR..." onkeyup="filterDSRTable()">
                            <button id="add-dsr-button" class="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 hidden" onclick="showAddDSRModal()">
                                Add DSR
                            </button>
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="target-table min-w-full">
                            <thead>
                                <tr>
                                    <th>DSR Name</th>
                                    <th>DSR ID</th>
                                    <th>Cluster</th>
                                    <th>Captain Name</th>
                                    <th>Last Month Actual</th>
                                    <th>This Month Actual</th>
                                    <th>Slab</th>
                                    <th id="actions-header" class="hidden">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="dsr-table-body">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- DE Performance View (Dealer Executives) -->
    <div id="de-performance-view" class="hidden">
        <div class="bg-white rounded-lg shadow overflow-hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <div>
                        <h2 class="text-lg font-medium text-gray-900">DE Performance</h2>
                        <p class="mt-1 text-sm text-gray-500" id="de-performance-description">View DE (Dealer Executive) performance similar to DSR performance.</p>
                    </div>
                    <div class="flex space-x-2">
                        <input type="text" id="de-search" class="search-input" placeholder="Search DE..." onkeyup="filterDETable()">
                        <button id="add-de-button" class="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 hidden" onclick="showAddDEModal()">Add DE</button>
                    </div>
                </div>
            </div>
            <div class="p-6">
                <div class="overflow-x-auto">
                        <table class="target-table min-w-full">
                        <thead>
                            <tr>
                                <th>Dealer Name</th>
                                <th>Location</th>
                                <th>DE Name</th>
                                <th>Last Month Actual</th>
                                <th>This Month Actual</th>
                                <th>Slab</th>
                                <th id="de-actions-header" class="hidden">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="de-table-body">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="security.js"></script>
    <script src="performance.js"></script>
    <script src="ui-ux.js"></script>
    <script src="data-management.js"></script>
    <script src="monitoring-analytics.js"></script>
    <script src="deployment-cicd.js"></script>
    <script src="core.js"></script>
    <script src="dashboard.js"></script>
    <script src="target-setting.js"></script>
    <script src="sales-log.js"></script>
    <script src="dsr-performance.js"></script>
    <script src="de-performance.js"></script>
    <script src="main.js"></script>
    
    <!-- Testing modules (only loaded in development) -->
    <script>
        // Load testing modules only in development
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            const testScript = document.createElement('script');
            testScript.src = 'tests.js';
            testScript.onload = () => {
                const testSuitesScript = document.createElement('script');
                testSuitesScript.src = 'test-suites.js';
                testSuitesScript.onload = () => {
                    const testRunnerScript = document.createElement('script');
                    testRunnerScript.src = 'test-runner.js';
                    testRunnerScript.onload = () => {
                        console.log('ðŸ§ª Testing modules loaded. Run window.runAllTests() to execute tests.');
                    };
                    document.head.appendChild(testRunnerScript);
                };
                document.head.appendChild(testSuitesScript);
            };
            document.head.appendChild(testScript);
        }
    </script>

    <!-- Accessibility Controls -->
    <button id="accessibility-toggle" class="accessibility-toggle" aria-label="Open accessibility settings">
        â™¿
    </button>

    <!-- Loading Spinner -->
    <div id="loading-spinner" class="loading-spinner hidden">
        <div class="spinner-content">
            <div class="spinner"></div>
            <div class="spinner-text">Loading...</div>
            <div class="spinner-progress">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Live Region for Screen Readers -->
    <div id="live-region" class="sr-only" aria-live="polite" aria-atomic="true"></div>
</body>
</html>